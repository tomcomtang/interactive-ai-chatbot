{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://a2ui-enhanced.dev/schema.json",
  "title": "Enhanced A2UI Schema - Based on Google v0.9 + Custom Extensions",
  "description": "Enhanced A2UI schema combining Google's v0.9 standard with custom component extensions",
  "type": "array",
  "items": {
    "oneOf": [
      {"$ref": "#/$defs/CreateSurfaceMessage"},
      {"$ref": "#/$defs/UpdateComponentsMessage"},
      {"$ref": "#/$defs/UpdateDataModelMessage"},
      {"$ref": "#/$defs/DeleteSurfaceMessage"}
    ]
  },
  "$defs": {
    "CreateSurfaceMessage": {
      "type": "object",
      "properties": {
        "createSurface": {
          "type": "object",
          "properties": {
            "surfaceId": {
              "type": "string",
              "description": "Unique identifier for the UI surface"
            },
            "catalogId": {
              "type": "string",
              "description": "Catalog identifier for component definitions",
              "default": "enhanced-a2ui-catalog"
            }
          },
          "required": ["surfaceId", "catalogId"],
          "additionalProperties": false
        }
      },
      "required": ["createSurface"],
      "additionalProperties": false
    },
    "UpdateComponentsMessage": {
      "type": "object",
      "properties": {
        "updateComponents": {
          "type": "object",
          "properties": {
            "surfaceId": {"type": "string"},
            "components": {
              "type": "array",
              "minItems": 1,
              "items": {"$ref": "#/$defs/Component"}
            }
          },
          "required": ["surfaceId", "components"],
          "additionalProperties": false
        }
      },
      "required": ["updateComponents"],
      "additionalProperties": false
    },
    "UpdateDataModelMessage": {
      "type": "object",
      "properties": {
        "updateDataModel": {
          "type": "object",
          "properties": {
            "surfaceId": {"type": "string"},
            "actorId": {"type": "string", "default": "agent"},
            "updates": {
              "type": "array",
              "items": {"$ref": "#/$defs/DataUpdate"}
            },
            "versions": {"$ref": "#/$defs/VersionVector"}
          },
          "required": ["surfaceId", "actorId", "updates"],
          "additionalProperties": false
        }
      },
      "required": ["updateDataModel"],
      "additionalProperties": false
    },
    "DeleteSurfaceMessage": {
      "type": "object",
      "properties": {
        "deleteSurface": {
          "type": "object",
          "properties": {
            "surfaceId": {"type": "string"}
          },
          "required": ["surfaceId"],
          "additionalProperties": false
        }
      },
      "required": ["deleteSurface"],
      "additionalProperties": false
    },
    "Component": {
      "type": "object",
      "allOf": [
        {"$ref": "#/$defs/ComponentCommon"},
        {
          "properties": {
            "component": {
              "oneOf": [
                {"$ref": "#/$defs/TextComponent"},
                {"$ref": "#/$defs/ImageComponent"},
                {"$ref": "#/$defs/ButtonComponent"},
                {"$ref": "#/$defs/CardComponent"},
                {"$ref": "#/$defs/RowComponent"},
                {"$ref": "#/$defs/ColumnComponent"},
                {"$ref": "#/$defs/ListComponent"},
                {"$ref": "#/$defs/DividerComponent"},
                {"$ref": "#/$defs/TextFieldComponent"},
                {"$ref": "#/$defs/CheckBoxComponent"},
                {"$ref": "#/$defs/SliderComponent"},
                {"$ref": "#/$defs/TableComponent"},
                {"$ref": "#/$defs/ChartComponent"},
                {"$ref": "#/$defs/ProgressComponent"},
                {"$ref": "#/$defs/BadgeComponent"},
                {"$ref": "#/$defs/StatisticComponent"},
                {"$ref": "#/$defs/VideoComponent"},
                {"$ref": "#/$defs/AudioComponent"},
                {"$ref": "#/$defs/GalleryComponent"},
                {"$ref": "#/$defs/CalendarComponent"},
                {"$ref": "#/$defs/TimelineComponent"},
                {"$ref": "#/$defs/TreeComponent"},
                {"$ref": "#/$defs/CarouselComponent"}
              ]
            }
          },
          "required": ["component"]
        }
      ]
    },
    "ComponentCommon": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for this component"
        },
        "weight": {
          "type": "number",
          "description": "Relative weight within Row/Column (CSS flex-grow)"
        }
      },
      "required": ["id"]
    },
    "DynamicString": {
      "oneOf": [
        {"type": "string"},
        {
          "type": "object",
          "properties": {"path": {"type": "string"}},
          "required": ["path"],
          "additionalProperties": false
        },
        {"$ref": "#/$defs/FunctionCall"}
      ]
    },
    "DynamicNumber": {
      "oneOf": [
        {"type": "number"},
        {
          "type": "object",
          "properties": {"path": {"type": "string"}},
          "required": ["path"],
          "additionalProperties": false
        },
        {"$ref": "#/$defs/FunctionCall"}
      ]
    },
    "DynamicBoolean": {
      "oneOf": [
        {"type": "boolean"},
        {
          "type": "object",
          "properties": {"path": {"type": "string"}},
          "required": ["path"],
          "additionalProperties": false
        },
        {"$ref": "#/$defs/LogicExpression"}
      ]
    },
    "ChildList": {
      "oneOf": [
        {
          "type": "array",
          "items": {"type": "string"},
          "description": "Static list of child component IDs"
        },
        {
          "type": "object",
          "properties": {
            "componentId": {"type": "string"},
            "path": {"type": "string"}
          },
          "required": ["componentId", "path"],
          "additionalProperties": false,
          "description": "Dynamic list generated from data model"
        }
      ]
    },
    "FunctionCall": {
      "type": "object",
      "properties": {
        "call": {"type": "string"},
        "args": {
          "type": "object",
          "additionalProperties": {"$ref": "#/$defs/DynamicValue"}
        },
        "returnType": {
          "type": "string",
          "enum": ["string", "number", "boolean", "array", "object", "any"],
          "default": "boolean"
        }
      },
      "required": ["call"]
    },
    "LogicExpression": {
      "oneOf": [
        {
          "properties": {
            "and": {
              "type": "array",
              "items": {"$ref": "#/$defs/LogicExpression"},
              "minItems": 1
            }
          },
          "required": ["and"]
        },
        {
          "properties": {
            "or": {
              "type": "array", 
              "items": {"$ref": "#/$defs/LogicExpression"},
              "minItems": 1
            }
          },
          "required": ["or"]
        },
        {
          "properties": {
            "not": {"$ref": "#/$defs/LogicExpression"}
          },
          "required": ["not"]
        },
        {"$ref": "#/$defs/FunctionCall"}
      ]
    },
    "CheckRule": {
      "allOf": [
        {"$ref": "#/$defs/LogicExpression"},
        {
          "type": "object",
          "properties": {
            "message": {"type": "string"}
          },
          "required": ["message"]
        }
      ]
    },
    "DataUpdate": {
      "type": "object",
      "properties": {
        "path": {"type": "string"},
        "value": {
          "oneOf": [
            {"type": "object"},
            {"type": "string"},
            {"type": "number"},
            {"type": "boolean"},
            {"type": "null"}
          ]
        },
        "hlc": {"type": "string"},
        "pos": {"type": "string"}
      },
      "required": ["path", "hlc"]
    },
    "VersionVector": {
      "type": "object",
      "additionalProperties": {"type": "string"}
    },
    "DynamicValue": {
      "oneOf": [
        {"type": "string"},
        {"type": "number"},
        {"type": "boolean"},
        {
          "type": "object",
          "properties": {"path": {"type": "string"}},
          "required": ["path"]
        },
        {"$ref": "#/$defs/FunctionCall"}
      ]
    },
    "TextComponent": {
      "type": "object",
      "properties": {
        "Text": {
          "type": "object",
          "properties": {
            "text": {"$ref": "#/$defs/DynamicString"},
            "variant": {
              "type": "string",
              "enum": ["h1", "h2", "h3", "h4", "h5", "body", "caption"]
            },
            "style": {
              "type": "object",
              "properties": {
                "color": {"type": "string"},
                "fontWeight": {"type": "string"},
                "textAlign": {"type": "string", "enum": ["left", "center", "right"]}
              }
            }
          },
          "required": ["text"]
        }
      },
      "required": ["Text"]
    },
    "ImageComponent": {
      "type": "object",
      "properties": {
        "Image": {
          "type": "object",
          "properties": {
            "url": {"$ref": "#/$defs/DynamicString"},
            "alt": {"$ref": "#/$defs/DynamicString"},
            "variant": {
              "type": "string",
              "enum": ["icon", "avatar", "smallFeature", "mediumFeature", "largeFeature", "header"]
            },
            "fit": {
              "type": "string",
              "enum": ["contain", "cover", "fill", "none", "scale-down"]
            },
            "width": {"$ref": "#/$defs/DynamicString"},
            "height": {"$ref": "#/$defs/DynamicString"}
          },
          "required": ["url"]
        }
      },
      "required": ["Image"]
    },
    "ButtonComponent": {
      "type": "object",
      "properties": {
        "Button": {
          "type": "object",
          "properties": {
            "text": {"$ref": "#/$defs/DynamicString"},
            "variant": {
              "type": "string",
              "enum": ["primary", "secondary", "outline", "ghost"]
            },
            "size": {
              "type": "string",
              "enum": ["small", "medium", "large"]
            },
            "disabled": {"$ref": "#/$defs/DynamicBoolean"},
            "action": {
              "type": "object",
              "properties": {
                "type": {"type": "string", "enum": ["submit", "navigate", "custom"]},
                "target": {"type": "string"},
                "data": {"type": "object"}
              }
            }
          },
          "required": ["text"]
        }
      },
      "required": ["Button"]
    },
    "CardComponent": {
      "type": "object",
      "properties": {
        "Card": {
          "type": "object",
          "properties": {
            "children": {"$ref": "#/$defs/ChildList"},
            "elevation": {"type": "number", "minimum": 0, "maximum": 4},
            "padding": {"type": "string"},
            "background": {"type": "string"},
            "borderRadius": {"type": "string"}
          },
          "required": ["children"]
        }
      },
      "required": ["Card"]
    },
    "RowComponent": {
      "type": "object",
      "properties": {
        "Row": {
          "type": "object",
          "properties": {
            "children": {"$ref": "#/$defs/ChildList"},
            "justify": {
              "type": "string",
              "enum": ["start", "center", "end", "spaceBetween", "spaceAround", "spaceEvenly", "stretch"]
            },
            "align": {
              "type": "string",
              "enum": ["start", "center", "end", "stretch"]
            },
            "gap": {"type": "string"}
          },
          "required": ["children"]
        }
      },
      "required": ["Row"]
    },
    "ColumnComponent": {
      "type": "object",
      "properties": {
        "Column": {
          "type": "object",
          "properties": {
            "children": {"$ref": "#/$defs/ChildList"},
            "justify": {
              "type": "string",
              "enum": ["start", "center", "end", "spaceBetween", "spaceAround", "spaceEvenly", "stretch"]
            },
            "align": {
              "type": "string",
              "enum": ["start", "center", "end", "stretch"]
            },
            "gap": {"type": "string"}
          },
          "required": ["children"]
        }
      },
      "required": ["Column"]
    },
    "ListComponent": {
      "type": "object",
      "properties": {
        "List": {
          "type": "object",
          "properties": {
            "children": {"$ref": "#/$defs/ChildList"},
            "direction": {"type": "string", "enum": ["vertical", "horizontal"]},
            "scrollable": {"type": "boolean"},
            "gap": {"type": "string"}
          },
          "required": ["children"]
        }
      },
      "required": ["List"]
    },
    "DividerComponent": {
      "type": "object",
      "properties": {
        "Divider": {
          "type": "object",
          "properties": {
            "direction": {"type": "string", "enum": ["horizontal", "vertical"]},
            "style": {
              "type": "object",
              "properties": {
                "color": {"type": "string"},
                "thickness": {"type": "string"}
              }
            }
          }
        }
      },
      "required": ["Divider"]
    },
    "TextFieldComponent": {
      "type": "object",
      "properties": {
        "TextField": {
          "type": "object",
          "properties": {
            "label": {"$ref": "#/$defs/DynamicString"},
            "placeholder": {"$ref": "#/$defs/DynamicString"},
            "value": {"$ref": "#/$defs/DynamicString"},
            "variant": {
              "type": "string",
              "enum": ["shortText", "longText", "number", "email", "password", "url"]
            },
            "required": {"type": "boolean"},
            "disabled": {"$ref": "#/$defs/DynamicBoolean"},
            "checks": {
              "type": "array",
              "items": {"$ref": "#/$defs/CheckRule"}
            }
          },
          "required": ["label"]
        }
      },
      "required": ["TextField"]
    },
    "CheckBoxComponent": {
      "type": "object",
      "properties": {
        "CheckBox": {
          "type": "object",
          "properties": {
            "label": {"$ref": "#/$defs/DynamicString"},
            "checked": {"$ref": "#/$defs/DynamicBoolean"},
            "disabled": {"$ref": "#/$defs/DynamicBoolean"}
          },
          "required": ["label"]
        }
      },
      "required": ["CheckBox"]
    },
    "SliderComponent": {
      "type": "object",
      "properties": {
        "Slider": {
          "type": "object",
          "properties": {
            "min": {"$ref": "#/$defs/DynamicNumber"},
            "max": {"$ref": "#/$defs/DynamicNumber"},
            "step": {"$ref": "#/$defs/DynamicNumber"},
            "value": {"$ref": "#/$defs/DynamicNumber"},
            "label": {"$ref": "#/$defs/DynamicString"},
            "showValue": {"type": "boolean"}
          },
          "required": ["min", "max", "value"]
        }
      },
      "required": ["Slider"]
    },
    "TableComponent": {
      "type": "object",
      "properties": {
        "Table": {
          "type": "object",
          "properties": {
            "columns": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "key": {"type": "string"},
                  "title": {"type": "string"},
                  "width": {"type": "string"},
                  "sortable": {"type": "boolean"}
                },
                "required": ["key", "title"]
              }
            },
            "data": {"$ref": "#/$defs/DynamicValue"},
            "pagination": {
              "type": "object",
              "properties": {
                "pageSize": {"type": "number"},
                "showPagination": {"type": "boolean"}
              }
            }
          },
          "required": ["columns", "data"]
        }
      },
      "required": ["Table"]
    },
    "ChartComponent": {
      "type": "object",
      "properties": {
        "Chart": {
          "type": "object",
          "properties": {
            "chartType": {
              "type": "string",
              "enum": ["bar", "line", "pie", "area", "scatter"]
            },
            "data": {"$ref": "#/$defs/DynamicValue"},
            "config": {
              "type": "object",
              "properties": {
                "title": {"type": "string"},
                "xAxis": {"type": "object"},
                "yAxis": {"type": "object"},
                "colors": {"type": "array", "items": {"type": "string"}}
              }
            }
          },
          "required": ["chartType", "data"]
        }
      },
      "required": ["Chart"]
    },
    "ProgressComponent": {
      "type": "object",
      "properties": {
        "Progress": {
          "type": "object",
          "properties": {
            "value": {"$ref": "#/$defs/DynamicNumber"},
            "max": {"$ref": "#/$defs/DynamicNumber"},
            "variant": {"type": "string", "enum": ["linear", "circular"]},
            "size": {"type": "string", "enum": ["small", "medium", "large"]},
            "showValue": {"type": "boolean"},
            "color": {"type": "string"}
          },
          "required": ["value", "max"]
        }
      },
      "required": ["Progress"]
    },
    "BadgeComponent": {
      "type": "object",
      "properties": {
        "Badge": {
          "type": "object",
          "properties": {
            "text": {"$ref": "#/$defs/DynamicString"},
            "variant": {
              "type": "string",
              "enum": ["default", "success", "warning", "error", "info"]
            },
            "size": {"type": "string", "enum": ["small", "medium", "large"]}
          },
          "required": ["text"]
        }
      },
      "required": ["Badge"]
    },
    "StatisticComponent": {
      "type": "object",
      "properties": {
        "Statistic": {
          "type": "object",
          "properties": {
            "title": {"$ref": "#/$defs/DynamicString"},
            "value": {"$ref": "#/$defs/DynamicValue"},
            "suffix": {"type": "string"},
            "prefix": {"type": "string"},
            "precision": {"type": "number"},
            "trend": {
              "type": "object",
              "properties": {
                "direction": {"type": "string", "enum": ["up", "down", "neutral"]},
                "value": {"type": "number"},
                "label": {"type": "string"}
              }
            }
          },
          "required": ["title", "value"]
        }
      },
      "required": ["Statistic"]
    },
    "VideoComponent": {
      "type": "object",
      "properties": {
        "Video": {
          "type": "object",
          "properties": {
            "url": {"$ref": "#/$defs/DynamicString"},
            "poster": {"$ref": "#/$defs/DynamicString"},
            "controls": {"type": "boolean"},
            "autoplay": {"type": "boolean"},
            "muted": {"type": "boolean"},
            "width": {"type": "string"},
            "height": {"type": "string"}
          },
          "required": ["url"]
        }
      },
      "required": ["Video"]
    },
    "AudioComponent": {
      "type": "object",
      "properties": {
        "Audio": {
          "type": "object",
          "properties": {
            "url": {"$ref": "#/$defs/DynamicString"},
            "controls": {"type": "boolean"},
            "autoplay": {"type": "boolean"},
            "title": {"$ref": "#/$defs/DynamicString"}
          },
          "required": ["url"]
        }
      },
      "required": ["Audio"]
    },
    "GalleryComponent": {
      "type": "object",
      "properties": {
        "Gallery": {
          "type": "object",
          "properties": {
            "images": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "url": {"type": "string"},
                  "alt": {"type": "string"},
                  "caption": {"type": "string"}
                },
                "required": ["url"]
              }
            },
            "variant": {"type": "string", "enum": ["grid", "carousel", "masonry"]},
            "columns": {"type": "number"},
            "gap": {"type": "string"}
          },
          "required": ["images"]
        }
      },
      "required": ["Gallery"]
    },
    "CalendarComponent": {
      "type": "object",
      "properties": {
        "Calendar": {
          "type": "object",
          "properties": {
            "value": {"$ref": "#/$defs/DynamicString"},
            "mode": {"type": "string", "enum": ["single", "range", "multiple"]},
            "minDate": {"type": "string"},
            "maxDate": {"type": "string"},
            "events": {"$ref": "#/$defs/DynamicValue"}
          }
        }
      },
      "required": ["Calendar"]
    },
    "TimelineComponent": {
      "type": "object",
      "properties": {
        "Timeline": {
          "type": "object",
          "properties": {
            "items": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "date": {"type": "string"},
                  "title": {"type": "string"},
                  "description": {"type": "string"},
                  "type": {"type": "string", "enum": ["milestone", "event", "task"]}
                },
                "required": ["date", "title"]
              }
            },
            "direction": {"type": "string", "enum": ["vertical", "horizontal"]}
          },
          "required": ["items"]
        }
      },
      "required": ["Timeline"]
    },
    "TreeComponent": {
      "type": "object",
      "properties": {
        "Tree": {
          "type": "object",
          "properties": {
            "data": {"$ref": "#/$defs/DynamicValue"},
            "expandable": {"type": "boolean"},
            "selectable": {"type": "boolean"}
          },
          "required": ["data"]
        }
      },
      "required": ["Tree"]
    },
    "CarouselComponent": {
      "type": "object",
      "properties": {
        "Carousel": {
          "type": "object",
          "properties": {
            "children": {"$ref": "#/$defs/ChildList"},
            "autoplay": {"type": "boolean"},
            "interval": {"type": "number"},
            "showDots": {"type": "boolean"},
            "showArrows": {"type": "boolean"},
            "infinite": {"type": "boolean"}
          },
          "required": ["children"]
        }
      },
      "required": ["Carousel"]
    }
  }
}